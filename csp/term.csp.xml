<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<CSP name="term.csp" application="/csp/glossary/" default="1"><![CDATA[
<!doctype html>
<html ng-app>
<head>
<meta charset="utf-8">
	<title>Term</title>
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">

</head>
<style type="text/css">
	
	.terms {
		list-style: none; 
	}
		.terms li {
		/*height: 50px; */
  		clear: both;
	  	padding-top: 15px; 
	  	padding: 4px;
	  	border: 1px solid rgb(221, 221, 221);
	  	box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.075);
	  	vertical-align:middle;
	  	line-height:40px;
	  	border-radius: 4px 4px 4px 4px;
	  	margin-top: 20px
	}

	
</style>
<script language ="javascript"> 

	// здесь обработчики будут
function control ($scope,$http){
	$scope.getTerm=function(termid){
			
			$http.get("/rest/json/term/"+termid).success(function(data){
			$scope.terms=data.children; $scope.getTranslations(terms[0].ID);}).error(function(data,status){
			$scope.alertzone="["+status+"] Ошибка загрузки термина :( ["+data+"]"; });
 			
		    }   
	 
		    $scope.getTerm(#($Get(%request.Data("id",1),1))#);
		    
		    $scope.getTranslations=function(termid){
		
			$http.get("/rest/json/translation/"+termid).success(function(data){
			$scope.translations=data.children;}).error(function(data,status){
			$scope.alertzone="["+status+"] Ошибка загрузки перевода :( ["+data+"]"; });
//			$scope.alertzone==data.children[0].Name;
		    }  
		    
		    $scope.getTranslations(#($Get(%request.Data("id",1),1))#);
		    		     
		    
		     
		    // $scope.getTranslations(#($Get(%request.Data("id",1),1))#);
		     //  добавление термина. Язык - английский или русский
	    	$scope.addTranslation = function (translation){

		    // что б кашэ был в курсе что мы ему предлагаем  
		    translation.class="Word.Translation";
		    // , {headers: { 'Content-Type': 'application/json; charset=utf-8'}}
		    $http.post("/rest/json/term",translation)
		    .success(function(data){$scope.getTranslations(#($Get(%request.Data("id",1),1))#); $scope.alertzone="Добавили перевод для "+terms[0].EnglishName;}).error(function(data,status){
			$scope.alertzone="["+status+"] Ошибка добавления перевода:( ["+data+"]"; });
		    } 

 }//control

</script>

<body  ng-controller="control">
<h1 ng-model="alertzone"><font color=red>{{alertzone}}</font></h1>
<CSP:INCLUDE PAGE="menu.csp"> 
<div class="container">
<!---->
<h1 ng-hide="true">
</h1>
	    <div class="row">
	    <article class="span12">
				<p>
				<ul class='nav nav-tabs nav-stacked'>
				
				
				<H2><br>{{terms[0].EnglishName}} - {{terms[0].RussianName}}<br></H2> 
				En: {{terms[0].EnglishDefinition}} <br>
				RU: {{terms[0].RussianDefinition}} <br>
				<a href='{{terms[0].FurtherRead}}'>Further Reading</a> <br>
				<br>
				<ul class="terms"> 
				Альтернативные варианты перевода: 
					<li ng-show="terms[0].TranslationName!=''" ng-repeat="translation in translations">
 					<b>{{translation.TranslationName}}</H3> </b> <br>		
 					Контекст: {{translation.TranslationContext}} <br>	
					Рейтинг: {{translation.TranslationRating}} <br>
				
				</ul> 
				
				<hr>
				<!--translation.Term='{{terms[0].ID}}';-->
				<ul class="addTranslationUi"> 
					<button ng-click="showState=!showState" class="btn">Добавить перевод</button> <br>
					<form ng-show="showState" name="AddTermForm" ng-model="term" 
						  		ng-submit= "translation.TermId='{{terms[0].ID}}';
						  		translation.TranslationRating='0'; addTranslation(translation); term.$setPristine();">
						<H3>{{terms[0].EnglishName}}</H3>
						<input type="text" placeholder="Перевод" ng-model="translation.TranslationName" required/> <br>
						<input type="text" placeholder="Контекст" ng-model="translation.TranslationContext"/> <br>
						<input type="submit" class="btn" value="Добавить"/>
					</form>
				</ul>
				
				
			
				</li>
				</ul>
				
				</p>
				
			</article>
	    </div>
	    
		
		<div id="footer">
			<div class=""></div>
			
		</div>
		
		
	</div>

    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="bootstrap/js/jquery.js"></script>
    <!-- ОООЧЕНЬ медленно
    <script src="http://code.jquery/jquery-latest.js"></script>	-->
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
    <script src="bootstrap/js/angular-cookies.min.js"></script>
    <script src="bootstrap/js/angular-loader.min.js"></script>
    <script src="bootstrap/js/angular-bootstrap-prettify.min.js"></script>
    <script src="bootstrap/js/angular-bootstrap.min.js"></script>
    <script src="bootstrap/js/angular-cookies.min.js"></script>
    <script src="bootstrap/js/angular-loader.min.js"></script>
    <script src="bootstrap/js/angular-resource.min.js"></script>
    <script src="bootstrap/js/angular-sanitize.min.js"></script>
    
</body>
</html></CSP>
]]></CSP>
</Export>
